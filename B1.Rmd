---
title: "B1"
author: "Nat"
date: "2023-10-31"
output: html_document
---
```{r}
library(tidyverse)
library(palmerpenguins)
head(penguins)
penguins
```
```{r}
missing_sum <- function(data,variable) {
  data %>% 
    summarize(across({{variable}}, ~sum(is.na(.x))))
}
missing_sum(penguins,bill_length_mm)
```


# Exercise 1 and 2
```{r}
#' Residual Plot for Simple Linear Models
#' 
#' This model creates a residual plot for a linear model with 1 explanatory variable. This can be used to test if the model meets the linearity and equal variance assumptions
#'
#' @param df **D**ata **f**rame being used, hence **df**
#' @param y Numeric vector from df, which is the response variable, or "y" variable, need to be in ""
#' @param b1 Numeric Vector from df, which is the explanatory variable. In simple linear regression, the slope associated with the first x variable would be b1, need to be in ""
#'
#' @return A graph

residual_plot <- function(df,y,b1){
  model_formula <- as.formula(paste(y, "~", b1))
  model <- lm(model_formula, data = df)
  ggplot(model, aes(x = .fitted, y = .resid)) +
  geom_point() +
  geom_hline(yintercept = 0, color="red") +
  labs(title='Residual Plot', x='Fitted Values', y='Residuals')
}
```

# Exercise 3
```{r}
# Test 1
x <- c(2,45,6,73,24,4,23,5,645,23,34,65)
y <- c(32,45,1,34,5,67,3,45,65,76,45,23)
test <- tibble(x,y)
residual_plot(test,"x","y")

#Test 2
library(palmerpenguins)
residual_plot(penguins, "bill_length_mm", "bill_depth_mm")

#Test 3
library(gapminder)
residual_plot(gapminder, "lifeExp", "gdpPercap")
```
# Exercise 4
```{r}
library(testthat)
residual_plot(penguins, "bill_length_mm","bill_depth_mm")
expect_error(residual_plot(penguins, "bill_length_mm","bill_depth_mm"))
```


